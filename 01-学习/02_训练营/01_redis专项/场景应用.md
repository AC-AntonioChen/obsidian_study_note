## 缓存
### 缓存异常场景
#### 缓存穿透
指缓存数据在数据库和redis都没有，而用户却不断发起请求。这种情况会导致请求压力打到数据库。
##### 解决措施
（1）接口层做校验，拦截住明显非法的查询（例如id<=0）
（2）根据key从缓存和数据库都没有取到的数据，写该key - null的键值对到redis，并设置短缓存时间，防止短时间暴力攻击 
（3）布隆过滤器（基于多hash的数据结构，可以快速判断某个值是否一定不存在）

#### 缓存击穿
指一条缓存数据在redis没有，但在数据库有，一般是缓存数据过期的情况，此时大量并发请求打到数据库。
##### 解决方案
（1）热点数据支持缓存续期，每次访问时更新缓存有效期：- **数据的一致性，不是靠“过期时间”来保证的，而是靠“写操作时的删除动作”来保证的。**
 （2）重建缓存加互斥锁，当线程拿到缓存发现缓存不存在就会尝试加锁，拿到锁的线程去数据库查并重建缓存，其他争抢失败的线程进行睡眠循环重试


#### 缓存雪崩
指大量缓存数据同时过期
##### 解决方案
1、缓存数据的过期时间设置随机，防止大量数据同时过期
2、重建缓存加互斥锁，当有线程竞争成功拿到锁后，负责去数据库读数据 并重建redis缓存，其他线程失败后sleep一段时间，循环重试